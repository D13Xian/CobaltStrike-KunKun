# CobaltStrike-[å¤å¤ç‰ˆ]-4.5-åŸºäºCobaltStrike_cat4.5é¡¹ç›®äºŒå¼€

> å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç»ƒä¹ æ—¶é•¿ä¸¤å¹´åŠçš„ä¸ªäººç»ƒä¹ ç”Ÿè”¡å¾å¤ã€‚
>
> Ps:å¤å¤Cs:åŸºäºCobaltStrike4.5-çŒ«çŒ«ç‰ˆäºŒå¼€å®Œæˆ (åŸdogcs4.4äºŒå¼€åŠŸèƒ½åŸºæœ¬éƒ½æœ‰)(è‡ªå¸¦ç ´è§£,ä¸éœ€è¦ä½¿ç”¨csagent.)
>
> æ–°ç‰ˆå®¢æˆ·ç«¯åªåœ¨Windows ä¸Ubuntuç³»ç»Ÿä¸Šæµ‹è¯•è¿‡ï¼ŒMac OSè¿˜æœªæµ‹è¯•ï¼Œå¦‚æœæœ‰macosç”¨æˆ·å‡ºç°ä½¿ç”¨é—®é¢˜è¯·åœ¨Issuesä¸­ç•™è¨€
>
> å¦‚æœ‰bugè¯·åœ¨lssuesä¸­æå‡ºï¼Œå¦‚æœæ”¶é›†åˆ°æ²™ç®±IPã€æµ‹ç»˜IPä¹Ÿæ¬¢è¿åœ¨Issuesé‡Œæå‡ºï¼Œè¢«åˆ†æäº†ä¹Ÿå¯ä»¥åœ¨issuesé‡Œæä¾›æˆªå›¾ï¼ˆæ³¨æ„æ‰“ç ï¼‰

## æ›´æ–°æ—¥å¿—æŒªåˆ°ä¸‹é¢äº†ï¼Œæ²¡æœ‰å¿…è¦çš„æ›´æ–°æ—¥å¿—è¢«æˆ‘åˆ é™¤äº†

æäº¤éœ€æ±‚è¯·åœ¨issuesé‡Œæäº¤

**å¦‚æœåœ¨å…¶ä»–æ¸ é“æäº¤ï¼ˆå¾®åšã€åšå®¢ç­‰ï¼‰æˆ‘å°±ç‹ ç‹ åœ°è¾±éª‚ä½ ã€‚**

## ğŸ˜˜è‡´æ•¬åŸä½œè€…

https://github.com/TryGOTry/CobaltStrike_Cat_4.5



## ç›¸å…³é…ç½®

`Javaç‰ˆæœ¬:11 è¿è¡Œå‰è¯·å…ˆé…ç½®CatClient.properties`

`ä¸ºå…¼å®¹CS-catå®¢æˆ·ç«¯ï¼ŒåŒCS-catåŸé…ç½®æ–‡ä»¶ç›¸åŒï¼Œä¸ºæ–°æ‰‹å¢åŠ äº†ä¸­æ–‡æ³¨é‡Š`

#### å®¢æˆ·ç«¯

ä¿®æ”¹äº†é»˜è®¤ä¸»é¢˜é¢œè‰²ï¼Œé»‘è‰²é…ç½®æ”¹ä¸ºçº¢è‰²ï¼Œé»˜è®¤ä¸ºçº¢è‰²ã€‚

> **java -jar cat_client.jar client**

##### é…ç½®æ–‡ä»¶è¯´æ˜(CatClient.properties)

|        é…ç½®å        |                           é…ç½®è¯´æ˜                           |
| :------------------: | :----------------------------------------------------------: |
|  CatClient.Version   | è‡ªå®šä¹‰ç‰ˆæœ¬å·,éœ€è¦å’ŒæœåŠ¡ç«¯ä¸€è‡´.(åˆ«äººæ‹¿åˆ°è¿™ä¸ªç‰ˆæœ¬çš„csä¿¡æ¯,å¦‚æœç‰ˆæœ¬å·ä¸å¯¹,ä¹Ÿæ— æ³•ç™»å½•TeamSever):String |
|  CatClient.OpenAuth  | æ˜¯å¦å¼€å¯authéªŒè¯,éœ€è¦å’ŒæœåŠ¡ç«¯å¯¹åº”(å¼€å¯åå®‰å…¨æ€§è¾ƒé«˜,ä½†æ˜¯å®¢æˆ·ç«¯æ— æ³•æ–­çº¿é‡è¿)ï¼štrue,false |
| CatClient.InjectSelf | æ˜¯å¦æ³¨å…¥è‡ªèº«,å¼€å¯çš„è¯Desktopï¼ŒKeylogger,Hashdump,PortScan,Mimikatz,PowerShellUnmanaged,Printscreen,Screenshot,Screenwatchä¼šæ³¨å…¥è‡ªèº«(å¼€å¯åæ— æ³•é€‚é…geacon_pro)ï¼štrue,false |
|   CatClient.theme    |            å®¢æˆ·ç«¯ä¸»é¢˜é…ç½®,0æ˜¯åŸç‰ˆ,1æ˜¯ç™½è‰²,2æ˜¯é»‘è‰²            |
|  CatClient.ini_name  |            è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å­˜æ”¾åç§°,é˜²æ­¢è¢«èœœç½è¯»å–             |
| stager.checksum-num  |     å…³äºstagerçš„ç›¸å…³é…ç½®(å¼ºçƒˆå»ºè®®ç”¨profileæ–‡ä»¶è‡ªå®šä¹‰url)     |
|    stager.x86-num    |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|  stager.x86-uri-len  |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|    stager.x64-num    |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|  stager.x64-uri-len  |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |

---

#### æœåŠ¡ç«¯

```bash
æ¨èä½¿ç”¨ubuntu18è¿è¡Œ
sudo apt install openjdk-11-jre-headless
sudo apt install openjdk-11-jdk
```

> **éœ€Java11è¿è¡Œï¼Œè¿è¡Œå‰è¯·å…ˆé…ç½®CatServer.properties**

##### é…ç½®æ–‡ä»¶è¯´æ˜(CatServer.properties)

|          é…ç½®å          |                           é…ç½®è¯´æ˜                           |
| :----------------------: | :----------------------------------------------------------: |
|    CatServer.Version     | è‡ªå®šä¹‰ç‰ˆæœ¬å·,éœ€è¦å’Œå®¢æˆ·ç«¯ä¸€è‡´.(åˆ«äººæ‹¿åˆ°è¿™ä¸ªç‰ˆæœ¬çš„csä¿¡æ¯,å¦‚æœç‰ˆæœ¬å·ä¸å¯¹,ä¹Ÿæ— æ³•ç™»å½•TeamSever)ï¼Œå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸² |
|      CatServer.port      |                          æœåŠ¡ç«¯ç«¯å£                          |
|     CatServer.store      |               TeamServerè¯ä¹¦æ–‡ä»¶(éœ€æ”¾å½“å‰ç›®å½•)               |
| CatServer.store-password |                           è¯ä¹¦å¯†ç                            |
|      CatServer.host      |    æœåŠ¡å™¨ip(å¯éšæ„å¡«å†™,åªæ˜¯å®¢æˆ·ç«¯ç›‘å¬æ—¶å€™ä¼šé»˜è®¤æ˜¾ç¤ºçš„ip)     |
|    CatServer.password    |                          æœåŠ¡ç«¯å¯†ç                           |
|  CatServer.profile-name  |                       profileæ–‡ä»¶åç§°                        |
|    CatServer.profile     | ä½¿ç”¨çš„profileæ–‡ä»¶,éœ€æ”¾åœ¨å½“å‰ç›®å½•ä¸‹(æ‰€ä»¥å¿…é¡»ä½¿ç”¨profileå¯åŠ¨)  |
|      CatServer.auth      |         æ˜¯å¦å¼€å¯åŒé‡éªŒè¯,éœ€è¦å’Œå®¢æˆ·ç«¯ä¸€è‡´:true,false         |
|    CatServer.authlog     | æ˜¯å¦å¼€å¯ç™»å½•æ—¥å¿—è®°å½•(åªæ˜¯åœ¨å®‰å…¨ç æ­£ç¡®,ä½†æ˜¯å¯†ç é”™è¯¯çš„æƒ…å†µä¸‹è®°å½•.):true,false |
|   CatServer.googleauth   |          å¼€å¯åŒé‡éªŒè¯å,å†å¼€å¯è°·æ­ŒéªŒè¯ç :true,false          |
|   CatServer.googlekey    | è°·æ­ŒäºŒæ¬¡éªŒè¯çš„key(å¯ç”¨java -jar cat_server.jar google å‘½ä»¤ç”Ÿæˆ) |
|    CatServer.safecode    | å¦‚æœå¼€å¯åŒé‡éªŒè¯,ä½†æ˜¯å…³é—­è°·æ­Œçš„è¯,å°±ä¼šå¯åŠ¨å®‰å…¨ç ,å›ºå®šä¸å˜(é™åˆ¶10ä½æ•°) |
|       CatServer.Iv       | AESåŠ å¯†çš„ivå€¼,æ–¹ä¾¿ç±»ä¼¼geacon_proç­‰é‡å†™çš„é¡¹ç›®ï¼Œé™åˆ¶ä¸º16ä½,åˆ‡å‹¿ä¹±æ”¹,ä¼šå‡ºç°æ— æ³•ä¸Šçº¿é—®é¢˜(é»˜è®¤:abcdefghijklmnop) |
|   stager.checksum-num    |     å…³äºstagerçš„ç›¸å…³é…ç½®(å¼ºçƒˆå»ºè®®ç”¨profileæ–‡ä»¶è‡ªå®šä¹‰url)     |
|      stager.x86-num      |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|    stager.x86-uri-len    |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|      stager.x64-num      |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |
|    stager.x64-uri-len    |                     å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€ä¸€è‡´                     |

##### ç›¸å…³å‘½ä»¤

```bash
è¿è¡ŒæœåŠ¡ç«¯:
chmod 755 teamserver
./teamserver

Windowsä¸‹è¿è¡Œ(æ”¹å¥½é…ç½®æ–‡ä»¶å)
java.exe -jar cat_server.jar server

è·å–googleäºŒæ¬¡éªŒè¯é…ç½®:
java -jar cat_server.jar google
ï¼ˆPs:å°†è·å–åˆ°çš„SecretKeyå¡«å…¥æœåŠ¡ç«¯é…ç½®ä¸­,æŠŠdata:image/jpeg;base64...è¿™ä¸€ä¸²å¤åˆ¶åˆ°æµè§ˆå™¨ä¸­æ‰“å¼€,ç”¨è°·æ­ŒéªŒè¯å™¨æ‰«æï¼‰

è¿è¡Œcnaè„šæœ¬

(å¦‚æœæ²¡å¼€å¯äºŒæ¬¡éªŒè¯)
java -jar cat_server.jar script [host] [port] [user] [password] [cnaè„šæœ¬]

(å¦‚æœå¼€å¯äºŒæ¬¡éªŒè¯)
java -jar cat_server.jar script [host] [port] [user] [password] [äºŒæ¬¡éªŒè¯çš„å¯†ç ] [cnaè„šæœ¬]
```

# CATåŸç‰ˆï¼šä¸€äº›äºŒå¼€è¯´æ˜

1. å»é™¤ListenerConfigä¸­çš„ç‰¹å¾æ°´å°

2. ä¿®æ”¹Stager Urlï¼ˆchecksum8ï¼‰æ ¡éªŒç®—æ³•

3. ä¿®æ”¹é»˜è®¤ç™»å½•inté•¿åº¦48879,è®©ç½‘ä¸Šçš„çˆ†ç ´è„šæœ¬æ— æ³•çˆ†ç ´

4. ä¿®æ”¹beaconé…ç½®ä¿¡æ¯çš„é»˜è®¤å¯†é’¥,ä¸ä¼šè¢«é»˜è®¤çš„è„šæœ¬è·å–åˆ°é…ç½®ä¿¡æ¯

5. å¢åŠ åœ¨çº¿ä¸»æœºç»Ÿè®¡

6. è‡ªå®šä¹‰bypass 360æ ¸æ™¶æ¨¡å¼:æˆªå›¾,Mimikatz,Hashdumpç­‰

7. å»æ‰é—ç•™çš„æš—æ¡©bug

8. å¯è‡ªå®šä¹‰ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å

9. æ–°åŠ ipå½’å®¿åœ°æŸ¥è¯¢

10. è‡ªå®šä¹‰åŒç«¯ç‰ˆæœ¬å·

    -------------------------------------------------------------



# å¤å¤ç‰ˆ ä¸€äº›äºŒå¼€è¯´æ˜

1.ä¿®æ”¹éƒ¨åˆ†shellcodeç‰¹å¾ï¼Œç°åœ¨å¸¸è§„yaraæ— æ³•è¯†åˆ«

2.å¢åŠ Malleable-C2-Randomizerï¼Œå¯ä»¥å¿«é€Ÿç”ŸæˆéšæœºURI profileæ–‡ä»¶ï¼ˆæ¨¡æ¿å¯è‡ªè¡Œä¿®æ”¹ï¼‰

3.è‡ªå®šä¹‰ExternalC2åŠŸèƒ½ã€‚

4.å¢åŠ ä¸Šçº¿è‡ªåŠ¨ç»´æƒæ’ä»¶ã€æ£€æµ‹ç›®æ ‡beaconæ˜¯å¦å­˜åœ¨æ€è½¯ã€ä¸Šçº¿æ¶ˆæ¯æ¨é€æ’ä»¶ã€æ²™ç®±IPé»‘åå•ã€è·¨å¹³å°ç›®æ ‡æ”¯æŒ

â€‹	é»˜è®¤ä¸å¯ç”¨ï¼Œå¯ç”¨æ‰§è¡Œï¼š`java -jar cat_server.jar script [host] [port] [user] [password] [cnaè„šæœ¬]ï¼‰`

5.æ›´æ–°IPå½’å±åœ°æ•°æ®åº“

6.å¢åŠ IPé»‘åå•åŠŸèƒ½ï¼ˆéœ€è¦sudoï¼Œä»…linuxå¹³å°æ”¯æŒï¼‰ï¼Œæ·»åŠ IPç›´æ¥ä¿®æ”¹ipé»‘åå•.txtå³å¯ï¼ˆæ³¨æ„ä¸è¦æ”¹åï¼‰ï¼Œä¿®æ”¹ä¹‹åé‡æ–°æ‰§è¡Œsudo ./teamserver

7.ä¿®æ”¹é»˜è®¤ç”Ÿæˆçš„cobaltstrike.storeå¯†ç 



## 2025.3.27
ä¿®å¤ https://github.com/D13Xian/CobaltStrike-KunKun/issues/1
ä¿®å¤äº†Versionå‚æ•°è½¬æ¢æˆæµ®ç‚¹æ•°çš„bug

## 2025.4.3
å®Œæˆ https://github.com/D13Xian/CobaltStrike-KunKun/issues/4
è¿˜æ˜¯ä¿ç•™äº†è‹±æ–‡ç‰ˆæœ¬ï¼Œä¸­æ–‡ç‰ˆæœ¬å¯ä»¥ç›´æ¥ä½¿ç”¨cat_client_zh.jar

windowså¹³å°æµ‹è¯•æ²¡é—®é¢˜ï¼Œmacå¹³å°å¦‚æœå‡ºç°ä¹±ç ï¼Œjavaå‘½ä»¤è¡Œæ·»åŠ -Dfile.encoding=utf-8å‚æ•°å³å¯ã€‚

ä¿®æ”¹äº†æ˜äº®ä¸»é¢˜ï¼Œç°åœ¨æ˜¯æ·¡ç²‰è‰²ï¼Œæ›´æŠ¤çœ¼ã€‚

å¯¹äºhttps://github.com/D13Xian/CobaltStrike-KunKun/issues/5

å¦‚æœæˆ‘æŠŠæˆ‘ç°åœ¨ç”¨çš„ç‰ˆæœ¬æ¨ä¸Šå»è‚¯å®šä¼šè¢«åˆ†æï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯ä¼šåœ¨ä»Šå¹´å¤§å‹ç½‘å®‰è”è°Šæ´»åŠ¨ä¹‹å‰PUSHä¸€ç‰ˆshellcodeï¼Œè”è°Šæ´»åŠ¨æœŸé—´åœæ­¢æ›´æ–°ã€‚


## ğŸ‘TODO - star 250+  ç»§ç»­å¼€å‘ä»¥ä¸‹åŠŸèƒ½ï¼ˆHVVæœŸé—´æš‚åœæ›´æ–°ï¼‰

 - å…¼å®¹JDK1.8

 - å¢åŠ å®¢æˆ·ç«¯è¡¨æ ¼æ’åºåŠŸèƒ½

 - å¢åŠ åˆ†ç»„åŠŸèƒ½ï¼ˆToolså†…éƒ¨ç‰ˆæœ¬ï¼‰

 - ç¼–è¯‘å‡ ä¸ªå…æ€Fscanã€mimikatazã€å‘æ—¥è‘µ

 - å¢åŠ ä¸€äº›åæ²™ç®±åŠŸèƒ½

 - æŠŠä¸Šçº¿è¯­éŸ³æç¤ºæ¢æˆé¸¡ä½ å¤ªç¾ï¼ˆé€ƒ



## ä¿®å¤ CVE-2022-39197

https://github.com/burpheart/CVE-2022-39197-patch



## ğŸŒ¹è‡´è°¢é¡¹ç›®

https://github.com/TryGOTry/CobaltStrike_Cat_4.5

https://github.com/lintstar/CS-AutoPostChain

https://github.com/raspberryhusky/antiVirusCheck

https://github.com/gloxec/CrossC2

https://github.com/trustedsec/CS-Situational-Awareness-BOF

https://github.com/qwqdanchun/Pillager/blob/main/README_ZH.md

https://github.com/lintstar/LSTAR
